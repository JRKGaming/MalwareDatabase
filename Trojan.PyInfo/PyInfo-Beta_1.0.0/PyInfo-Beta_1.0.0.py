import requests
import socket
import os
from pyuac import main_requires_admin


def check_connection():
	try:
		socket.create_connection(('google.com', 80))
		return True
	except:
		return False


def getUserDirectory():
	usrDir = os.path.expanduser("~")
	return usrDir


def getHostName():
	hostname = socket.gethostname()
	return hostname


def getIp():
	try:
		requestIp = requests.get('https://api.ipify.org')
		ip = requestIp.text
		return ip
	except:
		pass

 
@main_requires_admin
def main():
	is_connected = check_connection()
	if is_connected == True:
		pass
	else:
		quit()


	ipAddr = getIp()
	hostName = getHostName()
	userDir = getUserDirectory()

	with open(os.path.expanduser("~")+'\\AppData\\Roaming\\SystemInfo.txt', 'w') as f:
		f.write(f'IP Address: {ipAddr}\n\n\nHost Name: {hostName}\n\n\nUser Directory: {userDir}')


if __name__ == '__main__':
	main()